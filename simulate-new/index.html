<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Simulate New</title>
</head>
<body>
<script>
    // const simulateNew = function (target, ...arguments) {
    //     if (typeof target !== 'function') {
    //         throw 'simulateNew function the first param must be a function';
    //     }
    //
    //     let newObject = {};
    //     newObject.__proto__ = Object.create(target.prototype);
    //     let result = target.apply(newObject, ...arguments);
    //
    //     let isObject = typeof result === 'object' && typeof result !== null;
    //     let isFunction = typeof result === 'function';
    //
    //     return isObject || isFunction ? result : newObject;
    // }
    //
    const Person = function (name) {
        this.name = name;
    }

    Person.sayYourName = function () {
        console.log('I am ' + this.name);
    }

    // const andy = simulateNew(Person, 'Andy');
    // console.log(andy);

    function objectFactory() {
        let obj = {};

        // 拿取傳入的第一個引數, 就是 Person 建構函式
        let Constructor = [].shift.call(arguments);
        // 為了拿到原型的屬性, 把新 obj 的原型鍊(__proto__) 指向 Person 的 prototype 對應建構式物件
        obj.__proto__ = Constructor.prototype;
        // 用 apply 修改 Constructor (Person 函式)的 this 指向新 obj 物件, 並帶入其他引數
        Constructor.apply(obj, arguments);
        // 最後返回 obj 物件
        return obj;
    }

    const billy = objectFactory(Person, 'Billy');

    // console.log(billy)
    billy.sayYourName();


</script>
</body>
</html>
